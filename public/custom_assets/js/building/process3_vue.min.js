var testVue2=new Vue({el:"#test-vue2",data:{building_information:[],month_template:Immutable.Map({year:null,month:1,air_conditioned:null,non_air_conditioned:null,sumspace:null,hotel:null,hospital:null}),loading:!1},created:function(){var n=this;n.loading=!0,axios.get(getBuildingAjaxUrl+mainId).then(function(i){n.building_information=i.data,n.building_information=n.building_information.map(function(i){if(i.working_per_months.length<=0){var t=n.month_template.toObject();t.air_conditioned=i.air_conditioned,t.non_air_conditioned=i.non_air_conditioned,i.working_per_months.push(t)}return i}),n.loading=!1})},methods:{addMonth:function(n){var i=this;i.building_information=i.building_information.map(function(t){if(t.id.toString()===n.toString()){var o=t.working_per_months[t.working_per_months.length-1],r=i.month_template.toObject();for(var e in r)r[e]=o[e];t.working_per_months.push(r)}return t})},removeMonth:function(n,i){var t=this,o=!1;if(t.building_information.map(function(i){i.id.toString()===n.toString()&&i.working_per_months.length<=1&&(o=!0)}),o)return swal("ต้องมีเดือนอย่างน้อย 1 เดือน","","warning"),!1;swal({title:"ยืนยันการลบ?",text:"ยืนยันการลบเดือนหรือไม่?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"ยืนยัน",cancelButtonText:"ยกเลิก"}).then(function(){t.building_information=t.building_information.map(function(t){return t.id.toString()===n.toString()&&t.working_per_months.splice(t.working_per_months.indexOf(i),1),t})})},getSum:function(n,i){var t=0,o=this.building_information.filter(function(i){return i.id.toString()===n.toString()});return o.length>0&&(t=o[0].working_per_months.reduce(function(n,t){var o=0;return i.forEach(function(n){o+=isNaN(t[n])?0:parseFloat(t[n])}),n+o},0)),t},getAverage:function(n,i){var t=this.getSum(n,i),o=this.building_information.filter(function(i){return i.id.toString()===n.toString()});if(!o||o[0].working_per_months.length<=0)return null;var r=t/o[0].working_per_months.length;return Number.isInteger(r)?r:r.toFixed(2)},saveData:function(){var n=!0,i=this,t=$('input[name="_token"]').val();if(i.loading=!0,this.building_information.forEach(function(t){isNaN(i.getSum(t.id,["air_conditioned","non_air_conditioned","hotel","hospital"]))&&(n=!1),t.working_per_months.forEach(function(i){i.year||(n=!1)})}),!n)return swal("กรุณากรอกข้อมูลให้ครบก่อนบันทึก","","warning"),i.loading=!1,!1;axios.post(buildingProcess3Url+mainId,{building_information:i.building_information,_token:t}).then(function(n){window.location="/building/process4/"+mainId+"/edit"}).then(function(n){console.log(n),i.loading=!1})}}});